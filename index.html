<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OSN IPA - SDN 002 Sangatta Utara</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body { background-color: #2D9596; min-height: 100vh; font-family: 'sans-serif'; }
        .glass-card { background: rgba(255, 255, 255, 0.98); backdrop-filter: blur(10px); }
        .option-btn:active { transform: scale(0.98); }
        .developer-footer { opacity: 0.2; font-size: 0.65rem; color: #fff; text-align: center; padding: 20px 0; }
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-thumb { background: #267a7b; border-radius: 10px; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // DATA SOAL LENGKAP DARI DOKUMEN [cite: 1-197]
        const questionBank = [
            { id: 1, type: "pg", text: "Jika populasi katak di sebuah sawah menurun drastis akibat perburuan manusia, dampak jangka panjang yang paling mungkin terjadi adalah...", options: ["Populasi belalang menurun karena jumlah ular meningkat", "Populasi rumput meningkat karena jumlah belalang berkurang", "Populasi ular menurun drastis sehingga populasi elang terancam", "Populasi belalang meningkat drastis sehingga merusak tanaman padi"], answer: 3 }, // [cite: 4-8]
            { id: 2, type: "pg", text: "Upaya pelestarian penyu yang paling tepat untuk mengaitkan siklus hidup penyu dengan keberhasilannya mencapai usia dewasa adalah...", options: ["Melarang nelayan menangkap ikan", "Memindahkan telur ke penangkaran lalu melepas tukik secara bersamaan", "Memberi makan tukik di laut lepas agar cepat besar", "Memagari seluruh pantai agar hewan lain tidak masuk"], answer: 1 }, // [cite: 9-14]
            { id: 3, type: "pg", text: "Hubungan antara bentuk tubuh dan fungsi adaptasi yang benar adalah...", options: ["Kaktus berdaun duri untuk mempercepat penguapan", "Teratai berdaun lebar untuk menyerap oksigen lebih banyak dari air", "Kantong semar menghasilkan nektar untuk memerangkap serangga sebagai sumber nitrogen", "Kaktus berdaun duri untuk menyimpan cadangan makanan"], answer: 2 }, // [cite: 15-19]
            { id: 4, type: "pg", text: "Jika seseorang sering terpapar polusi asap rokok yang merusak elastisitas alveolus, gangguan yang terjadi adalah...", options: ["Udara tidak bisa masuk melalui hidung", "Penyaringan kuman di tenggorokan terhenti", "Penyerapan oksigen ke dalam darah menjadi tidak maksimal", "Frekuensi bernapas menjadi lebih lambat"], answer: 2 }, // [cite: 20-24]
            { id: 5, type: "pg", text: "Tindakan yang paling tepat terkait kesehatan reproduksi pada fase pubertas remaja laki-laki adalah...", options: ["Mengurangi aktivitas fisik agar tidak lelah", "Menjaga kebersihan organ reproduksi dan memahami itu proses alami", "Mengonsumsi obat hormonal", "Menghindari bersosialisasi dengan lawan jenis"], answer: 1 }, // [cite: 25-28]
            { id: 6, type: "pg", text: "Suara di dalam gedung bioskop terdengar tidak jelas dan tumpang tindih karena...", options: ["Bunyi merambat lebih lambat", "Terjadi gaung karena jarak dinding pemantul sangat dekat", "Dinding gedung menyerap bunyi", "Bunyi tidak mengalami pemantulan"], answer: 1 }, // [cite: 29-34]
            { id: 7, type: "pg", text: "Ketika benda digeser mendekati lampu senter, maka ukuran bayangan benda pada layar akan...", options: ["Menjadi lebih kecil dan tajam", "Menjadi lebih besar dan kabur", "Tetap sama", "Hilang"], answer: 1 }, // [cite: 35-40]
            { id: 8, type: "pg", text: "Keunggulan sendi peluru (lengan atas & belikat) adalah...", options: ["Gerakan satu arah agar stabil", "Memungkinkan gerakan memutar sehingga sangat fleksibel", "Menghindari gesekan agar tidak nyeri", "Membatasi gerakan"], answer: 1 }, // [cite: 41-46]
            { id: 9, type: "pg", text: "Tahapan siklus air yang paling terganggu langsung akibat hilangnya vegetasi hutan adalah...", options: ["Evaporasi", "Kondensasi", "Infiltrasi (Penyerapan ke tanah)", "Presipitasi"], answer: 2 }, // [cite: 47-52]
            { id: 10, type: "pg", text: "Pada pembuatan magnet elektromagnet, jika jumlah baterai ditambah, maka...", options: ["Paku menjadi panas dan hilang magnetnya", "Daya tarik magnet pada paku semakin kuat", "Kutub magnet bertukar posisi", "Paku menolak benda logam"], answer: 1 }, // [cite: 53-58]
            { id: 11, type: "pg", text: "Penggunaan plastik pada gagang panci aluminium didasarkan pada sifat...", options: ["Konduktor panas yang baik", "Isolator panas agar tangan tidak melepuh", "Mempercepat air mendidih", "Mengubah panas menjadi energi gerak"], answer: 1 }, // [cite: 59-64]
            { id: 12, type: "pg", text: "Berdasarkan komponen penyusunnya (air, garam, mineral), air laut dikelompokkan ke dalam...", options: ["Zat Tunggal", "Unsur", "Campuran Homogen", "Campuran Heterogen"], answer: 2 }, // [cite: 65-70]
            { id: 13, type: "pg", text: "Perubahan energi yang terjadi pada kincir air di sungai deras untuk listrik adalah...", options: ["Energi potensial -> panas -> listrik", "Energi kinetik -> gerak kincir -> listrik", "Energi kimia -> listrik", "Energi listrik -> gerak"], answer: 1 }, // [cite: 71-76]
            { id: 14, type: "pg", text: "Bumi berada di antara Matahari dan Bulan dalam satu garis lurus menyebabkan...", options: ["Gerhana Matahari Total", "Gerhana Bulan Total", "Bulan Sabit", "Gerhana Matahari Cincin"], answer: 1 }, // [cite: 77-82]
            { id: 15, type: "pg", text: "Alternatif bijaksana penggunaan pestisida kimia berlebih adalah...", options: ["Berhenti bertani", "Menggunakan predator alami (biopestisida)", "Membakar lahan setelah panen", "Mengganti tanaman plastik"], answer: 1 }, // [cite: 83-88]
            { id: 16, type: "pg", text: "Penumpang terdorong ke depan saat bus direm mendadak membuktikan bahwa gaya...", options: ["Mengubah bentuk", "Mengubah arah", "Menghentikan benda bergerak", "Membuat benda diam jadi bergerak"], answer: 2 }, // [cite: 89-94] (Konteks inersia/kelembaman akibat gaya hambat)
            { id: 17, type: "pg", text: "Jika otot jantung sebelah kiri lemah, dampak bagi tubuh adalah...", options: ["Seluruh tubuh kekurangan suplai oksigen dan mudah lelah", "Darah tidak bisa masuk paru-paru", "Tekanan darah meningkat drastis", "Produksi sel darah merah berhenti"], answer: 0 }, // [cite: 95-100]
            { id: 18, type: "pg", text: "Planet Merah dengan gunung tertinggi Olympus Mons adalah...", options: ["Venus", "Mars", "Yupiter", "Saturnus"], answer: 1 }, // [cite: 101-106]
            { id: 19, type: "pgk", text: "Manakah ciri-ciri pubertas pada perempuan? (Jawaban benar > 1)", options: ["Tumbuhnya jakun", "Mengalami menstruasi pertama", "Pinggul mulai melebar", "Dada menjadi lebih bidang"], answer: [1, 2] }, // [cite: 107-112]
            { id: 20, type: "pgk", text: "Pilih pasangan sendi dan fungsinya yang tepat: (Jawaban benar > 1)", options: ["Sendi Engsel: Gerak satu arah", "Sendi Pelana: Gerak dua arah", "Sendi Geser: Gerak 360 derajat", "Sendi Putar: Hubungan atlas dan leher"], answer: [0, 1, 3] }, // [cite: 113-117]
            { id: 21, type: "pgk", text: "Peristiwa yang menunjukkan cahaya dapat dibiaskan? (Jawaban benar > 1)", options: ["Pensil terlihat patah di gelas air", "Terbentuk bayangan di belakang tubuh", "Dasar kolam jernih terlihat lebih dangkal", "Cahaya senter menembus jendela"], answer: [0, 2] }, // [cite: 118-121]
            { id: 22, type: "pgk", text: "Tumbuhan yang berkembang biak dengan umbi lapis? (Jawaban benar > 1)", options: ["Bawang Merah", "Kentang", "Bunga Bakung", "Jahe"], answer: [0, 2] }, // [cite: 122-125]
            { id: 23, type: "pgk", text: "Tindakan manusia yang mengganggu keseimbangan ekosistem hutan? (Jawaban benar > 1)", options: ["Sistem tebang pilih", "Alih fungsi hutan jadi sawit masif", "Reboisasi lahan gundul", "Perburuan liar predator"], answer: [1, 3] }, // [cite: 126-130]
            { id: 24, type: "pgk", text: "Komponen listrik dan fungsinya yang benar: (Jawaban benar > 1)", options: ["Baterai: Sumber energi", "Saklar: Memutus/menyambung arus", "Kabel: Penampung daya", "Lampu: Pengubah listrik ke cahaya"], answer: [0, 1, 3] }, // [cite: 131-135]
            { id: 25, type: "pgk", text: "Sifat-sifat yang dimiliki magnet permanen? (Jawaban benar > 1)", options: ["Memiliki dua kutub", "Kutub senama tarik-menarik", "Menarik emas dan plastik", "Kekuatan terbesar di kutub"], answer: [0, 3] }, // [cite: 136-139]
            { id: 26, type: "pgk", text: "Peristiwa yang memerlukan kalor (menyerap panas)? (Jawaban benar > 1)", options: ["Es batu mencair", "Uap air di tutup panci jadi titik air", "Air mendidih saat dipanaskan", "Pembuatan agar-agar jadi padat"], answer: [0, 2] }, // [cite: 140-143]
            { id: 27, type: "pgk", text: "Sumber energi alternatif terbarukan? (Jawaban benar > 1)", options: ["Sinar Matahari", "Batubara", "Angin", "Gas Alam"], answer: [0, 2] }, // [cite: 144-148]
            { id: 28, type: "pgk", text: "Akibat dari peristiwa revolusi Bumi? (Jawaban benar > 1)", options: ["Siang dan malam", "Perubahan musim", "Perbedaan lama siang dan malam", "Gerak semu harian matahari"], answer: [1, 2] }, // [cite: 149-151]
            { id: 29, type: "pgk", text: "Pasangan hewan dan alat geraknya yang sesuai? (Jawaban benar > 1)", options: ["Ikan dengan sirip", "Burung dengan sayap", "Ular dengan otot perut", "Katak dengan ekor untuk melompat"], answer: [0, 1, 2] }, // [cite: 152-153]
            { id: 30, type: "pgk", text: "Fungsi bagian darah yang benar? (Jawaban benar > 1)", options: ["Sel darah merah angkut oksigen", "Sel darah putih bunuh kuman", "Keping darah bantu pembekuan", "Plasma darah memompa darah"], answer: [0, 1, 2] }, // [cite: 154-159]
            { id: 31, type: "pgk", text: "Contoh campuran heterogen (komponen bisa dibedakan)? (Jawaban benar > 1)", options: ["Larutan gula", "Kopi tubruk", "Es sirup rata", "Air dengan pasir"], answer: [1, 3] }, // [cite: 160-164]
            { id: 32, type: "pgk", text: "Upaya penghematan energi listrik di rumah? (Jawaban benar > 1)", options: ["Matikan lampu saat tidak dipakai", "Gunakan mesin cuci tiap satu baju kotor", "Cabut kabel dari stop kontak", "Nyalakan TV sepanjang malam"], answer: [0, 2] }, // [cite: 165-169]
            { id: 33, type: "pgk", text: "Pasangan hewan dan alat pernapasan yang benar? (Jawaban benar > 1)", options: ["Belalang: Trakea", "Cacing: Kulit basah", "Paus: Insang", "Berudu: Insang"], answer: [0, 1, 3] }, // [cite: 170-172]
            { id: 34, type: "bool", text: "Kupu-kupu mengalami tahapan ulat dan kepompong sebelum menjadi dewasa, sehingga disebut mengalami metamorfosis sempurna.", options: ["Sesuai", "Tidak Sesuai"], answer: 0 }, // [cite: 173-174]
            { id: 35, type: "bool", text: "Jika sebuah magnet batang dipotong menjadi dua bagian, maka masing-masing potongan hanya akan memiliki satu kutub saja.", options: ["Sesuai", "Tidak Sesuai"], answer: 1 }, // [cite: 175-176]
            { id: 36, type: "bool", text: "Matahari adalah pusat tata surya karena semua planet dan benda langit lainnya berputar mengelilinginya akibat gaya gravitasi Matahari.", options: ["Sesuai", "Tidak Sesuai"], answer: 0 }, // [cite: 177-178]
            { id: 37, type: "bool", text: "Sendok logam yang terasa panas saat dimasukkan ke dalam kopi panas adalah contoh perpindahan panas secara konveksi.", options: ["Sesuai", "Tidak Sesuai"], answer: 1 }, // [cite: 179-180]
            { id: 38, type: "bool", text: "Emas murni dan garam dapur merupakan contoh zat tunggal karena terdiri dari materi yang sejenis.", options: ["Sesuai", "Tidak Sesuai"], answer: 0 }, // [cite: 181-182]
            { id: 39, type: "bool", text: "Buah apel yang jatuh dari pohon ke bawah disebabkan oleh adanya gaya magnet bumi.", options: ["Sesuai", "Tidak Sesuai"], answer: 1 }, // [cite: 183]
            { id: 40, type: "bool", text: "Tumbuhnya kumis dan dada menjadi lebih bidang adalah ciri perkembangan sekunder pada remaja laki-laki di masa pubertas.", options: ["Sesuai", "Tidak Sesuai"], answer: 0 }, // [cite: 184-185]
            { id: 41, type: "bool", text: "Dalam sebuah jaring-jaring makanan, jamur dan bakteri berperan sebagai produsen yang menghasilkan makanan sendiri.", options: ["Sesuai", "Tidak Sesuai"], answer: 1 }, // [cite: 186-187]
            { id: 42, type: "bool", text: "Bunyi dapat merambat di ruang hampa udara (vakum) seperti di luar angkasa dengan sangat cepat.", options: ["Sesuai", "Tidak Sesuai"], answer: 1 }, // [cite: 188-189]
            { id: 43, type: "bool", text: "Penyakit osteoporosis adalah kondisi di mana tulang menjadi rapuh karena kekurangan kalsium.", options: ["Sesuai", "Tidak Sesuai"], answer: 0 }, // [cite: 190-192]
            { id: 44, type: "bool", text: "Hujan asam adalah fenomena alam normal yang membantu menyuburkan tanah.", options: ["Sesuai", "Tidak Sesuai"], answer: 1 }, // [cite: 193-194]
            { id: 45, type: "bool", text: "Pelestarian hewan langka yang dilakukan di habitat aslinya disebut pelestarian In-situ.", options: ["Sesuai", "Tidak Sesuai"], answer: 0 } // [cite: 195-197]
        ];

        function App() {
            const [view, setView] = useState('start');
            const [user, setUser] = useState({ nama: '', kelas: '', hp: '' });
            const [currentIndex, setCurrentIndex] = useState(0);
            const [answers, setAnswers] = useState({});
            const [timeLeft, setTimeLeft] = useState(3600); // 60 menit
            const [results, setResults] = useState([]);
            const [showAdmin, setShowAdmin] = useState(false);
            const [showNav, setShowNav] = useState(false);

            useEffect(() => {
                if (view === 'quiz' && timeLeft > 0) {
                    const timer = setInterval(() => setTimeLeft(prev => prev - 1), 1000);
                    return () => clearInterval(timer);
                } else if (timeLeft === 0) {
                    processFinish();
                }
            }, [view, timeLeft]);

            const handleAnswerChange = (val) => {
                const q = questionBank[currentIndex];
                if (q.type === 'pgk') {
                    let current = answers[currentIndex] || [];
                    if (current.includes(val)) current = current.filter(x => x !== val);
                    else current = [...current, val];
                    setAnswers({...answers, [currentIndex]: current});
                } else {
                    setAnswers({...answers, [currentIndex]: val});
                }
            };

            const processFinish = () => {
                if (view !== 'quiz') return;
                let totalScore = 0;
                questionBank.forEach((q, i) => {
                    const userAns = answers[i];
                    if (q.type === 'pgk') {
                        if (Array.isArray(userAns) && userAns.length > 0) {
                            let correctCount = 0;
                            let wrongCount = 0;
                            userAns.forEach(a => q.answer.includes(a) ? correctCount++ : wrongCount++);
                            let point = (correctCount - wrongCount) / q.answer.length;
                            totalScore += Math.max(0, point);
                        }
                    } else if (userAns === q.answer) {
                        totalScore += 1;
                    }
                });

                const finalScore = Math.round((totalScore / questionBank.length) * 100);
                const resultData = { ...user, skor: finalScore, status: finalScore >= 70 ? 'LULUS' : 'TIDAK LULUS', waktu: new Date().toLocaleString() };
                
                const existing = JSON.parse(localStorage.getItem('osn_results') || '[]');
                localStorage.setItem('osn_results', JSON.stringify([...existing, resultData]));
                setView('finish');
            };

            const downloadExcel = () => {
                const data = JSON.parse(localStorage.getItem('osn_results') || '[]');
                const ws = XLSX.utils.json_to_sheet(data);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, "Hasil");
                XLSX.writeFile(wb, "Hasil_OSN_IPA_Sangatta.xlsx");
            };

            // START VIEW
            if (view === 'start') return (
                <div className="min-h-screen flex items-center justify-center p-6">
                    <div className="glass-card p-8 rounded-3xl shadow-2xl w-full max-w-md">
                        <div className="text-center mb-8">
                            <h1 className="text-2xl font-black text-teal-800 leading-tight uppercase">Seleksi OSN IPA</h1>
                            <p className="text-teal-600 font-bold">SDN 002 Sangatta Utara</p>
                        </div>
                        <div className="space-y-4">
                            <label className="block">
                                <span className="text-gray-700 text-sm font-bold ml-1">Nama Lengkap</span>
                                <input type="text" className="w-full mt-1 p-3 border-2 border-teal-100 rounded-xl focus:border-teal-500 outline-none" onChange={e => setUser({...user, nama: e.target.value})} />
                            </label>
                            <label className="block">
                                <span className="text-gray-700 text-sm font-bold ml-1">Kelas</span>
                                <input type="text" className="w-full mt-1 p-3 border-2 border-teal-100 rounded-xl focus:border-teal-500 outline-none" onChange={e => setUser({...user, kelas: e.target.value})} />
                            </label>
                            <label className="block">
                                <span className="text-gray-700 text-sm font-bold ml-1">Nomor HP</span>
                                <input type="number" className="w-full mt-1 p-3 border-2 border-teal-100 rounded-xl focus:border-teal-500 outline-none" onChange={e => setUser({...user, hp: e.target.value})} />
                            </label>
                            <button onClick={() => user.nama && user.kelas ? setView('quiz') : alert('Isi Nama & Kelas!')} className="w-full bg-orange-500 hover:bg-orange-600 text-white font-black py-4 rounded-2xl shadow-lg transition-all mt-4 uppercase tracking-wider">Mulai Ujian</button>
                        </div>
                    </div>
                </div>
            );

            // QUIZ VIEW
            if (view === 'quiz') return (
                <div className="min-h-screen flex flex-col items-center">
                    <div className="w-full max-w-2xl p-4 flex justify-between items-center text-white sticky top-0 z-10 bg-[#2D9596]">
                        <div className="bg-white/20 px-4 py-1 rounded-full text-xs">
                            <p className="font-bold uppercase tracking-widest">{user.nama}</p>
                        </div>
                        <div className="text-center bg-white/20 px-6 py-1 rounded-full border border-white/30">
                            <p className="text-[10px] uppercase font-bold">Waktu Tersisa</p>
                            <p className="text-lg font-mono font-bold">{Math.floor(timeLeft/60)}:{String(timeLeft%60).padStart(2,'0')}</p>
                        </div>
                        <button onClick={() => setShowNav(true)} className="bg-teal-900/50 hover:bg-teal-900 p-2 rounded-lg transition-colors">
                            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M4 6h16M4 12h16m-7 6h7"/></svg>
                        </button>
                    </div>

                    <div className="w-full max-w-2xl px-4 pb-24">
                        <div className="glass-card p-6 rounded-3xl shadow-xl min-h-[400px]">
                            <div className="flex justify-between items-center mb-4">
                                <span className="bg-teal-100 text-teal-800 text-xs font-black px-3 py-1 rounded-full uppercase">Soal {currentIndex + 1}</span>
                                {questionBank[currentIndex].type === 'pgk' && <span className="text-[10px] text-orange-600 font-black uppercase">Jawaban benar > 1</span>}
                            </div>
                            
                            <h2 className="text-lg font-bold text-gray-800 mb-6 leading-relaxed">
                                {questionBank[currentIndex].text}
                            </h2>

                            <div className="space-y-3">
                                {questionBank[currentIndex].options.map((opt, i) => {
                                    const isSelected = questionBank[currentIndex].type === 'pgk' 
                                        ? (answers[currentIndex] || []).includes(i)
                                        : answers[currentIndex] === i;
                                    
                                    return (
                                        <button key={i} onClick={() => handleAnswerChange(i)}
                                            className={`w-full p-4 text-left rounded-2xl border-2 transition-all option-btn flex items-center ${
                                                isSelected 
                                                ? 'bg-teal-500 border-teal-600 text-white shadow-md' 
                                                : 'bg-white border-gray-100 text-gray-700 hover:border-teal-200'
                                            }`}>
                                            <span className={`w-8 h-8 rounded-full mr-4 flex items-center justify-center font-bold border-2 ${isSelected ? 'bg-white text-teal-600 border-white' : 'bg-gray-100 border-gray-200'}`}>
                                                {String.fromCharCode(65+i)}
                                            </span>
                                            <span className="font-semibold">{opt}</span>
                                        </button>
                                    );
                                })}
                            </div>
                        </div>
                    </div>

                    <div className="fixed bottom-0 w-full max-w-2xl glass-card border-t p-4 flex justify-between gap-3 shadow-2xl rounded-t-3xl">
                        <button disabled={currentIndex === 0} onClick={() => setCurrentIndex(c => c-1)} className="flex-1 py-3 bg-gray-100 rounded-xl font-bold text-gray-500 disabled:opacity-30">KEMBALI</button>
                        <button className="flex-1 py-3 bg-yellow-400 rounded-xl font-bold text-yellow-900">RAGU-RAGU</button>
                        {currentIndex === questionBank.length - 1 
                            ? <button onClick={() => confirm("Kirim sekarang?") && processFinish()} className="flex-1 py-3 bg-red-500 text-white rounded-xl font-black">KIRIM</button>
                            : <button onClick={() => setCurrentIndex(c => c+1)} className="flex-1 py-3 bg-teal-600 text-white rounded-xl font-black">LANJUT</button>
                        }
                    </div>

                    {showNav && (
                        <div className="fixed inset-0 bg-black/60 z-50 p-6 flex items-center justify-center">
                            <div className="bg-white rounded-3xl p-6 w-full max-w-md max-h-[70vh] overflow-y-auto relative">
                                <button onClick={() => setShowNav(false)} className="absolute top-4 right-4 text-gray-400">TUTUP</button>
                                <h3 className="font-black text-teal-800 mb-4 text-center">NAVIGASI SOAL</h3>
                                <div className="grid grid-cols-5 gap-2">
                                    {questionBank.map((_, i) => (
                                        <button key={i} onClick={() => {setCurrentIndex(i); setShowNav(false);}} className={`p-2 rounded-lg font-bold text-sm ${answers[i] !== undefined ? 'bg-teal-500 text-white' : 'bg-gray-100 text-gray-400'}`}>
                                            {i+1}
                                        </button>
                                    ))}
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );

            // FINISH VIEW
            if (view === 'finish') return (
                <div className="min-h-screen flex items-center justify-center p-6 text-center">
                    <div className="glass-card p-10 rounded-3xl shadow-2xl w-full max-w-md">
                        <div className="w-24 h-24 bg-teal-100 rounded-full flex items-center justify-center mx-auto mb-6">
                            <span className="text-5xl">âœ…</span>
                        </div>
                        <h1 className="text-3xl font-black text-teal-800 mb-2">Terima Kasih!</h1>
                        <p className="text-gray-500 mb-8 font-medium italic">Jawaban Anda telah terkirim ke panitia.</p>
                        
                        <div className="bg-teal-50 p-6 rounded-2xl mb-8">
                            <p className="text-teal-600 uppercase text-[10px] font-black tracking-widest mb-1">Skor Akhir</p>
                            <p className="text-6xl font-black text-teal-800">{JSON.parse(localStorage.getItem('osn_results') || '[]').pop()?.skor}</p>
                        </div>

                        <button onClick={() => window.location.reload()} className="text-teal-600 font-bold border-2 border-teal-100 px-8 py-2 rounded-full hover:bg-teal-50">Keluar Sistem</button>
                    </div>
                </div>
            );

            return null;
        }

        // ADMIN PANEL COMPONENT
        function AdminPanel({show, setShow, downloadExcel}) {
            const [pass, setPass] = useState("");
            const [isAuth, setIsAuth] = useState(false);

            if (!show) return <button onClick={() => setShow(true)} className="fixed bottom-2 right-2 text-[8px] opacity-10 text-white">ADMIN</button>;

            return (
                <div className="fixed inset-0 bg-black/90 z-[100] flex items-center justify-center p-4">
                    <div className="bg-white rounded-3xl p-6 w-full max-w-2xl overflow-hidden flex flex-col max-h-[85vh]">
                        {!isAuth ? (
                            <div className="text-center py-10">
                                <h3 className="font-bold mb-4">Password Admin</h3>
                                <input type="password" onChange={e => e.target.value === '1995' && setIsAuth(true)} className="border-2 p-2 rounded-xl text-center outline-none" autoFocus />
                                <button onClick={() => setShow(false)} className="block mx-auto mt-4 text-gray-400 text-sm">Batal</button>
                            </div>
                        ) : (
                            <>
                                <div className="flex justify-between items-center mb-6">
                                    <h3 className="font-black text-xl text-teal-800">REKAP NILAI SISWA</h3>
                                    <button onClick={() => setShow(false)} className="bg-red-50 p-2 text-red-500 rounded-lg font-bold">TUTUP</button>
                                </div>
                                <div className="overflow-y-auto flex-grow rounded-xl border">
                                    <table className="w-full text-left text-xs">
                                        <thead className="sticky top-0 bg-teal-600 text-white">
                                            <tr><th className="p-3">NAMA</th><th className="p-3">KELAS</th><th className="p-3">SKOR</th><th className="p-3">STATUS</th></tr>
                                        </thead>
                                        <tbody>
                                            {JSON.parse(localStorage.getItem('osn_results') || '[]').map((r, i) => (
                                                <tr key={i} className="border-b hover:bg-gray-50">
                                                    <td className="p-3 font-bold">{r.nama}</td>
                                                    <td className="p-3">{r.kelas}</td>
                                                    <td className="p-3 font-mono font-bold text-teal-600">{r.skor}</td>
                                                    <td className={`p-3 font-black ${r.status === 'LULUS' ? 'text-green-500' : 'text-orange-500'}`}>{r.status}</td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                                <button onClick={downloadExcel} className="mt-6 bg-green-600 text-white py-4 rounded-2xl font-black shadow-lg">DOWNLOAD EXCEL (.xlsx)</button>
                            </>
                        )}
                    </div>
                </div>
            );
        }

        function Root() {
            const [showAdmin, setShowAdmin] = useState(false);
            const downloadExcel = () => {
                const data = JSON.parse(localStorage.getItem('osn_results') || '[]');
                const ws = XLSX.utils.json_to_sheet(data);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, "Hasil");
                XLSX.writeFile(wb, "Hasil_OSN_IPA.xlsx");
            };

            return (
                <div className="relative">
                    <App />
                    <AdminPanel show={showAdmin} setShow={setShowAdmin} downloadExcel={downloadExcel} />
                    <footer className="developer-footer">developer Hildegardis Septianita</footer>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<Root />);
    </script>
</body>
</html>